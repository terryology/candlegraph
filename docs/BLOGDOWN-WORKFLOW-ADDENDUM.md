# Blogdown Workflow Discovery - Addendum

**Date:** February 17, 2026  
**Context:** Discovered during first test post creation

---

## The Problem

When testing the content workflow for the first time, Hugo shortcodes weren't rendering - they appeared as literal text `{{< brand-specs ... >}}` instead of the styled vault components.

## Root Cause

**Incorrect file type:** Using `.Rmd` files with `output: html_document` generates `.html` files, which Hugo serves directly without processing shortcodes.

**The confusion:** The original documentation suggested using `blogdown::html_page`, and existing posts had `html_document` in their front matter but somehow had `.md` files alongside them.

**What actually happened:** The `.md` files in existing posts were generated by `blogdown::serve_site()` or `blogdown::build_site()`, not by manually knitting.

## The Solution

**Use .Rmarkdown files, not .Rmd:**

```
.Rmd → html_document → .html (Hugo doesn't process shortcodes)
.Rmarkdown → blogdown → .markdown (Hugo processes shortcodes!)
```

## The Correct Workflow

### Creating Posts

**Always use blogdown's post creator:**
```r
blogdown::new_post(
  title = "Post Title",
  ext = ".Rmarkdown"  # CRITICAL - not .Rmd
)
```

This creates:
```
content/post/YYYY-MM-DD-slug/
└── index.Rmarkdown
```

### Building Posts

**Never knit manually.** Instead:

1. Edit your `.Rmarkdown` file
2. Save it
3. Run `blogdown::serve_site()` in R Console
4. Blogdown automatically converts `.Rmarkdown` → `.markdown`
5. Hugo processes `.markdown` (including shortcodes)
6. Preview appears in browser

### What Gets Committed

Commit both files to Git:
- `index.Rmarkdown` (your source with R code)
- `index.markdown` (blogdown's output with R results embedded)

## Why This Matters

**Shortcodes only work in markdown files that Hugo processes.**

- `.html` files bypass Hugo's template system
- `.markdown` files go through Hugo's full processing pipeline
- All Candlegraph vault components are Hugo shortcodes
- Without Hugo processing, you get literal `{{< ... >}}` text

## File Extension Comparison

| Extension | Converts To | Hugo Processes? | Shortcodes Work? | Use Case |
|-----------|-------------|-----------------|------------------|----------|
| `.Rmd` | `.html` | No | No | Standalone HTML docs |
| `.Rmarkdown` | `.markdown` | Yes | Yes | Hugo sites with shortcodes |
| `.md` | N/A | Yes | Yes | Plain markdown (no R) |

For Candlegraph: **Always use .Rmarkdown**

## Updated Snippet

The snippet now:
- Uses `html_document` output (this is correct for `.Rmarkdown` files)
- Sources both `data_sync.R` AND `post_brief.R`
- Assumes you're working in a file created by `blogdown::new_post()`

```yaml
---
title: "Post Title"
output: html_document
---
```

The `html_document` output is processed differently when used with `.Rmarkdown` files - it generates `.markdown`, not `.html`. This is a blogdown convention.

## Troubleshooting

### Shortcodes showing as literal text
- Check file extension: Must be `.Rmarkdown` (not `.Rmd`)
- Check generated file: Should be `.markdown` (not `.html`)
- Use `blogdown::serve_site()` (don't knit manually)

### get_brief() not found
- Source both files in setup chunk:
  ```r
  source(here::here("data_sync.R"))
  source(here::here("post_brief.R"))
  ```

### Files not generating
- Make sure `blogdown::serve_site()` is running
- Save your `.Rmarkdown` file to trigger rebuild
- Check R console for errors

## Documentation Updated

The following files were updated to reflect this workflow:

- `CONTENT-WORKFLOW-SUMMARY.md` - Updated workflow steps, file organization, and deployment pipeline
- `CANDLEGRAPH-SNIPPETS.md` - Updated usage instructions and troubleshooting
- `BLOGDOWN-WORKFLOW-ADDENDUM.md` - This document

## Key Takeaway

**The "knit" button is not part of the Candlegraph workflow.** 

Use `blogdown::new_post()` to create and `blogdown::serve_site()` to build. This is the blogdown way, and it's what makes Hugo shortcodes work correctly.

---

**End of Addendum**
